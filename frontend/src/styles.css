
/* ---------- THEME VARIABLES ---------- */
:root{
  /* Light theme - Green aurora inspired (high contrast) */
  --bg: #fbfff8; /* very pale mint */
  --panel: #ffffff; /* surface / cards */
  --text: #03322b; /* dark teal for best readability */
  --muted: #5b766a; /* muted text */
  --primary: #009875; /* vivid aurora green */
  --accent: #8ff7cf; /* soft accent glow */
  --accent-rgb: 143,247,207;
  /* explicit accent color variable (hex preferred). Falls back to --accent if not set.) */
  --accent_color: var(--accent);

  /* Headings (provide clear hierarchy) */
  --heading-1: #012f28;
  --heading-2: #05443a;
  --heading-3: #066a50;

  /* UI elements */
  --link: var(--primary);
  --border: rgba(2,40,34,0.08);
  --glass: rgba(255,255,255,0.75);
  --glass-border: rgba(2,40,34,0.06);
  --radius: 14px;
  --shadow: 0 10px 30px rgba(2,6,23,0.06);

  /* Cards, code, and surfaces */
  --card-bg: #ffffff;
  --card-border: rgba(2,40,34,0.06);
  --code-bg: #eefcf4;

  /* Feedback colors */
  --success: #007f59;
  --warning: #ffb84d;
  --danger: #d64545;
  --success-rgb: 0,127,89;
  --danger-rgb: 214,69,69;

  /* Misc */
  --font-sans: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
}

[data-theme="dark"]{
  /* Dark theme - deep blue / purple aurora inspiration (high contrast) */
  --bg: #031026; /* deep navy */
  --panel: #07162a; /* slightly lighter surface */
  --text: #e8f6ff; /* pale cyan/white for readability */
  --muted: #92a8b3; /* muted text */
  --primary: #6ec8ff; /* icy blue aurora */
  --accent: #b78bff; /* purple glow accent */
  --accent-rgb: 183,139,255;
  /* explicit accent color variable for dark theme */
  --accent_color: var(--accent);

  /* Headings */
  --heading-1: #e8f6ff;
  --heading-2: #d7eeff;
  --heading-3: #bcdcff;

  /* UI elements */
  --link: var(--primary);
  --border: rgba(255,255,255,0.06);
  --glass: rgba(8,14,24,0.55);
  --glass-border: rgba(255,255,255,0.04);
  --radius: 14px;
  --shadow: 0 10px 30px rgba(0,0,0,0.6);

  /* Cards, code, and surfaces */
  --card-bg: #071426;
  --card-border: rgba(255,255,255,0.03);
  --code-bg: #031826;

  /* Feedback colors */
  --success: #32d6a4;
  --warning: #ffb86b;
  --danger: #ff6b88;
  --success-rgb: 50,214,164;
  --danger-rgb: 255,107,136;

  /* Misc */
  --font-sans: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
}

/* basic page */
body{font-family: var(--font-sans); margin:0; background:var(--bg); color:var(--text)}
/* make main content occupy 85% of the viewport width and stay centered */
/* Use 65vw for a comfortable, centered reading width */
main{width:65vw;max-width:none;margin:24px auto;padding:0 16px;box-sizing:border-box}
a{color:var(--primary)}

/* theme transition helper */
:root{
  --theme-transition: 220ms;
}

/* apply smooth transitions to common elements when theme changes */
body, header, main, nav, .auth-modal, .auth-modal-overlay, button, input, a {
  transition: background-color var(--theme-transition) ease, color var(--theme-transition) ease, border-color var(--theme-transition) ease, box-shadow var(--theme-transition) ease;
}

/* Auth modal / glass styling */
.auth-modal-overlay{
  position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:9999;background:rgba(0,0,0,0.35);
}
.auth-modal{
  width:420px;max-width:95%;border-radius:var(--radius);padding:0;background:var(--glass);backdrop-filter: blur(8px) saturate(120%);box-shadow:var(--shadow);overflow:hidden;border:1px solid var(--glass-border);
}
.auth-close{position:absolute;right:14px;top:8px;border:none;background:transparent;font-size:20px;cursor:pointer}

/* small input, button niceties */
input{border:1px solid rgba(0,0,0,0.08);background:transparent}
button{transition:all 160ms ease}
button:hover{transform:translateY(-1px)}

/* small helpers */
.rounded { border-radius: 10px }

/* Global subtle glassy background layer to give the whole site a soft aurora glow */
body::before{
  content: "";
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: -1;
  background: radial-gradient(ellipse at 10% 20%, rgba(138,255,206,0.10), transparent 10%),
              radial-gradient(ellipse at 90% 80%, rgba(138,200,255,0.08), transparent 12%);
  filter: blur(48px);
  opacity: 0.9;
}

/* Glass panel utility - use on cards/panels to get morphism */
.glass-panel{
  background: var(--glass);
  border: 1px solid var(--glass-border);
  backdrop-filter: blur(10px) saturate(120%);
  box-shadow: var(--shadow);
  border-radius: var(--radius);
}

/* Auth form tokens and modern input/button styles */
.auth-form{width:100%;box-sizing:border-box}
.auth-label{display:block;font-size:13px;margin-bottom:8px;color:var(--muted);font-weight:600}
.auth-input{margin-bottom:12px}
.auth-input input{
  width:100%;padding:12px 14px;border-radius:10px;border:1px solid var(--border);box-sizing:border-box;background:var(--card-bg);color:var(--text);outline:none;transition:box-shadow var(--theme-transition) ease,transform var(--theme-transition) ease,border-color var(--theme-transition) ease;
}
.auth-input input:focus{
  box-shadow: 0 8px 30px rgba(0,0,0,0.12);
  transform: translateY(-1px);
  border-color: rgba(0,0,0,0.08);
}

/* Buttons - modern, no heavy outlines, smooth hover */
.btn{display:inline-flex;align-items:center;justify-content:center;padding:10px 16px;border-radius:10px;border:1px solid transparent;cursor:pointer;transition:transform var(--theme-transition) ease,box-shadow var(--theme-transition) ease,opacity var(--theme-transition) ease}
.btn:disabled{opacity:0.6;cursor:default}
.btn:hover:not(:disabled){transform:translateY(-3px)}

.btn-primary{
  background: linear-gradient(90deg,var(--primary),var(--accent));
  color: var(--panel);
  box-shadow: 0 8px 28px rgba(2,6,23,0.12);
  border: none;
}

.btn-ghost{background:transparent;color:var(--text);border:1px solid var(--border)}

/* AAIedu image-button - thin border, modern look */
.aaiedu-btn{display:inline-flex;align-items:center;justify-content:center;padding:6px;border-radius:10px;border:1px solid var(--border);background:transparent;cursor:pointer;transition:transform var(--theme-transition) ease,box-shadow var(--theme-transition) ease}
.aaiedu-btn:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(0,0,0,0.08)}
.aaiedu-img{height:54px;display:block}

.auth-sep{height:1px;background:linear-gradient(90deg, rgba(0,0,0,0.04), rgba(0,0,0,0.02));margin:14px 0;border-radius:1px}

/* small centered heading used inside auth panels */
.auth-heading{display:block;text-align:center;margin-bottom:10px;color:var(--muted);font-weight:700}

/* subtle colored glow for glass panels (uses --accent-rgb) */
.glass-panel{
  /* existing properties kept, add subtle accent glow */
  box-shadow: 0 10px 30px rgba(0,0,0,0.06), 0 6px 24px rgba(var(--accent-rgb),0.08);
}

/* ensure modal close button is visible in dark theme */
.auth-close{position:absolute;right:14px;top:8px;border:none;background:transparent;font-size:20px;cursor:pointer;color:var(--text)}

/* Make auth modal use the glass-panel styles */
.auth-modal{padding:18px;}
.auth-modal .glass-panel{padding:16px}

/* Logout button explicit red color regardless of theme */
.btn-logout{background:#d64545;color:#fff;border:none}
.btn-logout:hover{background:#b03030}

/* Header / Nav styles to match theme tokens */
.site-header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:14px 20px; /* base padding */
  border-bottom:1px solid var(--border);
  background:var(--panel);
  color:var(--text);
}

/* increase header height on larger screens for better balance */
@media (min-width: 1200px) {
  .site-header{ padding:18px 40px }
}

.site-title{display:flex;align-items:center;gap:10px;font-weight:700;font-size:18px;color:var(--heading-1)}
.site-title-text{font-weight:700;font-size:18px}

/* Logo styling: match theme and be responsive */
.site-logo{height:28px;width:auto;display:block}
@media (min-width: 900px){ .site-logo{height:34px} }
@media (min-width: 1400px){ .site-logo{height:42px} }

/* small role label before the logo */
.site-role{font-size:12px;color:var(--muted);font-weight:700;margin-right:6px;letter-spacing:0.06em}
.nav-links{display:flex;gap:8px;align-items:center}
.nav-link{padding:6px 10px;border-radius:8px;text-decoration:none;color:var(--text);font-weight:600;transition:background-color var(--theme-transition) ease,color var(--theme-transition) ease,transform var(--theme-transition) ease}
.nav-link:hover{background:transparent}
.nav-link-label{display:inline-block;transition:transform var(--theme-transition) ease,color var(--theme-transition) ease}
.nav-link:hover .nav-link-label{transform:scale(1.06)}

/* Keep active background stable on hover; only scale the label */
.nav-link.nav-link-active:hover{background:linear-gradient(90deg,var(--accent),rgba(255,255,255,0.02))}
.nav-link-active{background:linear-gradient(90deg,var(--accent),rgba(255,255,255,0.02));color:var(--heading-2);box-shadow:0 6px 18px rgba(2,6,23,0.08)}

.header-actions{display:flex;gap:8px;align-items:center;margin-left:12px}
.auth-username{font-weight:700;color:var(--heading-2);margin-right:8px}
.auth-btn{padding:6px 10px;border-radius:8px}

/* Make header buttons smaller and match token styles */
.btn-sm{padding:8px 12px;border-radius:8px;font-size:14px}

/* Theme toggle label */
.theme-selected-label{font-size:12px;color:var(--muted);font-weight:600}

.theme-toggle-btn{padding:6px;border-radius:8px;border:none;background:transparent;color:var(--text);cursor:pointer}
.theme-toggle-btn:hover{transform:translateY(-2px)}

/* make the theme toggle button more prominent with a variable border and subtle glow */
.theme-toggle-btn{
  background: linear-gradient(180deg, rgba(var(--accent-rgb),0.06), transparent 60%);
  /* fallback: use --accent (hex) if rgba(var(--accent-rgb),...) is not supported by the browser/build output */
  border: 1px solid var(--accent) !important;
  border: 1px solid rgba(var(--accent-rgb),0.85) !important;
  padding:8px; display:inline-flex; align-items:center; justify-content:center;
  border-radius:10px; transition:box-shadow var(--theme-transition) ease, transform var(--theme-transition) ease, border-color var(--theme-transition) ease;
}
.theme-toggle-btn:hover{transform:translateY(-3px); box-shadow: 0 10px 26px rgba(var(--accent-rgb),0.10)}
.theme-toggle-btn:focus{outline:none; box-shadow: 0 6px 26px rgba(var(--accent-rgb),0.18); border-color: rgba(var(--accent-rgb),1)}

/* Notifications - top-right stack (glass morphism + slide animations) */
.notification-container{
  position: fixed;
  /* lowered so notifications appear below the taller header */
  top: 30vh;
  right: 20px;
  display: flex;
  flex-direction: column;
  gap: 10px;
  z-index: 99999;
  align-items: flex-end;
  max-width: 360px;
  padding: 8px;
  pointer-events: none; /* allow clicks through padding area */
}

@media (min-width: 1200px) {
  .notification-container { top: 110px; }
}

.notification-item{
  pointer-events: auto;
  min-width: 280px;
  max-width: 360px;
  /* default: subtle success/green glass */
  background: linear-gradient(135deg, rgba(var(--success-rgb),0.10), var(--glass));
  backdrop-filter: blur(10px) saturate(140%);
  border: 1px solid rgba(var(--success-rgb),0.12);
  border-radius: 12px;
  padding: 12px 14px;
  color: var(--text); /* use theme text color for best contrast in light/dark */
  display: flex;
  align-items: flex-start;
  gap: 10px;
  box-shadow: 0 12px 36px rgba(2,6,23,0.10);
  transform: translateX(110%);
  opacity: 0;
  transition: transform 260ms ease, opacity 260ms ease;
}
.notification-item.entering{ transform: translateX(0); opacity: 1 }
.notification-item.exiting{ transform: translateX(110%); opacity: 0 }
.notification-item .notification-content{ flex: 1 }
.notification-item .notification-close{ border: none; background: transparent; color: var(--text); font-size: 16px; padding: 6px 8px; cursor: pointer; border-radius:6px }
.notification-item.is-error{
  border-color: rgba(var(--danger-rgb),0.22);
  box-shadow: 0 14px 40px rgba(var(--danger-rgb),0.10);
  /* red glassy background for errors */
  background: linear-gradient(135deg, rgba(var(--danger-rgb),0.12), rgba(0,0,0,0.06));
}
.notification-item.is-error .notification-content{ color: var(--text) }
.notification-item.is-error .notification-close{ color: var(--text) }

/* close button: use theme text variable and a subtle hover state */
.notification-item .notification-close{ color: var(--text); transition: color 160ms ease, transform 160ms ease }
.notification-item .notification-close:hover{ color: var(--heading-1); transform: scale(1.08) }



/* app root layout so footer can stick to the bottom */
.app-root{min-height:100vh;display:flex;flex-direction:column}
main{flex:1}

/* Footer - theme aware using CSS variables so colors change with theme */
.site-footer{
  background: var(--panel);
  border-top: 1px solid var(--border);
  color: var(--muted);
  padding: 14px 16px;
}
.site-footer-inner{
  max-width: 900px;
  margin: 0 auto;
  display: flex;
  gap: 12px;
  align-items: center;
  justify-content: space-between;
}
.site-footer .footer-link{
  color: var(--muted);
  text-decoration: none;
  font-weight:600;
  margin-left: 12px;
}
.site-footer .footer-link:hover{ color: var(--text); text-decoration: underline }

/* NotFound page styles */
.not-found-page{display:flex;align-items:center;justify-content:center;min-height: 60vh;padding: 28px;}
.not-found-content{text-align:center;padding:36px;border-radius:12px;max-width:720px;}
.not-found-code{font-size:96px;line-height:1;font-weight:800;color:var(--heading-1);margin-bottom:8px;}
.not-found-title{font-size:28px;margin:6px 0 8px 0;color:var(--heading-2);}
.not-found-desc{color:var(--muted);font-size:16px;margin:0 auto;max-width:640px;}


/* Profile page specific styles */

.profile-grid{display:grid;grid-template-columns:1fr;gap:1.5rem}
.profile-card{padding:1rem;border-radius:12px;transition:box-shadow var(--theme-transition) ease}
.profile-card .field-row{display:flex;gap:1rem;align-items:center}
.profile-card .field-row input{flex:1;min-width:0;padding:0.85rem;border-radius:0.6rem;border:1px solid var(--border);background:var(--card-bg);color:var(--text);font-size:1rem}

/* On hover only animate box-shadow (no transform) using accent color */
.profile-card:hover{box-shadow: 0 1.8rem 3.2rem rgba(var(--accent-rgb),0.10), 0 8px 30px rgba(2,6,23,0.06)}

/* Sessions table scaled up and responsive */
.session-table{width:100%;border-collapse:collapse;font-size:0.98rem}
.session-table th,.session-table td{padding:0.75rem 0.6rem;border-bottom:1px dashed var(--border);font-size:0.95rem}

/* Make table cells wrap by default so the table does not force horizontal scrolling.
  Keep session id truncated and compact; let long user-agent and route values wrap. */
.session-table td{white-space:normal;word-break:break-word;overflow-wrap:anywhere;vertical-align:top}
.session-table td.session-id{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:18ch}
.session-table td.user-agent{max-width:48ch}
.session-current{
  /* subtle uniform highlight for current session using theme variables (no border) */
  background: rgba(var(--success-rgb), 0.04);
}

/* Confirmation modal styles reuse existing auth modal classes, add small color variants */
.confirm-yes{
  /* Use theme variables only, avoid gradients for clarity */
  background: var(--success);
  color: var(--panel);
  border: none;
  box-shadow: 0 6px 18px rgba(var(--success-rgb),0.10);
}
.confirm-no{background:transparent;border:1px solid var(--danger);color:var(--danger)}

/* Glassy blurred overlay for confirmation modal */
.confirm-overlay{
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  /* semi-transparent background which slightly tints based on theme */
  background: linear-gradient(180deg, rgba(0,0,0,0.18), rgba(0,0,0,0.12));
  backdrop-filter: blur(8px) saturate(130%);
  -webkit-backdrop-filter: blur(8px) saturate(130%);
}

/* ensure auth-modal-overlay base remains but confirm-overlay is stronger */
.auth-modal-overlay{z-index:9999}

/* Larger headings inside profile */
.profile-card h3{font-size:1.125rem;margin-bottom:0.6rem}

@media (min-width: 900px) {
  .profile-card{padding:1.25rem}
  .profile-card .field-row input{font-size:1.05rem}
  .session-table th,.session-table td{font-size:1rem}
}

/* Ensure inputs and selects inside auth-input class inherit theme text color
   and match card background (handles direct input.auth-input usage) */
input.auth-input, select.auth-input, textarea.auth-input {
  color: var(--text);
  background: var(--card-bg);
  border: 1px solid var(--border);
}

/* Also support wrapper usage: .auth-input input */
.auth-input input, .auth-input select, .auth-input textarea {
  color: var(--text);
  background: var(--card-bg);
}

/* Make save buttons inline and slightly smaller so they fit next to inputs */
.field-row .btn { white-space: nowrap; padding: 0.55rem 0.9rem; font-size: 0.95rem }
.name-row{display:flex;gap:1rem;align-items:center;justify-content:center}
.name-row .auth-input{flex:0 1 40ch}
/* column helper: stack label + input and constrain width */
.col{display:flex;flex-direction:column;gap:6px;flex:0 1 40ch;min-width:0}

/* input-with-save places a save button visually inside the input at the right edge.
   Use absolute positioning for the button while keeping the input full width and
   add right padding to the input so text doesn't overlap the button. */
.input-with-save{position:relative;width:100%}
.input-with-save .auth-input, .input-with-save .auth-input input, .input-with-save .auth-input select {
  padding-right: 100px; /* reserve space for the save button */
  box-sizing: border-box;
}
/* Save button visually inside the input at the right edge (compact pill). */
.input-with-save .save-btn{
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(calc(-50%)) !important; /* nudge a couple px lower to visually center */
  z-index: 6;
  padding: 0 14px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border-radius: 18px; /* pill */
  height: 34px; /* compact, matches desired visual */
  min-height: 34px;
  line-height: 1;
  font-size: 0.85rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  background: linear-gradient(90deg, var(--primary), var(--accent));
  color: var(--panel);
  border: none;
  box-shadow: 0 6px 14px rgba(var(--accent-rgb),0.10);
  box-sizing: border-box;
  will-change: box-shadow; /* minimize layout shifts */
}

/* Ensure single-line inputs are not rendered as huge boxes: enforce reasonable height */
input.auth-input, .auth-input input, .profile-card input.auth-input, .profile-card .auth-input input {
  height: 44px; /* consistent control height */
  min-height: 40px;
  line-height: 1.2;
  padding: 10px 14px;
  box-sizing: border-box;
}

/* Stronger fallback rules if other selectors override input sizing (use sparingly) */
.profile-card input.auth-input, input.auth-input, .auth-input input {
  display: inline-block !important;
  height: 42px !important;
  min-height: 38px !important;
  max-height: 46px !important;
  padding-top: 8px !important;
  padding-bottom: 8px !important;
  overflow: hidden !important;
  white-space: nowrap !important;
  text-overflow: ellipsis !important;
}

/* nicer select styling for preferred_language */
.auth-select{appearance:none;padding:0.75rem 1rem;border-radius:8px;border:1px solid var(--border);background:linear-gradient(180deg, var(--card-bg), rgba(0,0,0,0.02));color:var(--text);font-weight:600}
.auth-select:focus{box-shadow:0 8px 24px rgba(0,0,0,0.08)}

/* created/updated timestamps shown next to select */
.timestamps{display:flex;flex-direction:column;gap:6px;margin-left:1rem;min-width:230px;text-align:right;color:var(--muted);font-size:0.95rem}
.timestamps .ts{background:transparent;padding:6px 8px;border-radius:8px}

/* Change password area: center and constrain width */
.password-area{max-width:520px;margin:0 auto;display:flex;flex-direction:column;gap:0.6rem;align-items:center}
.password-area .auth-input input{max-width:100%;padding:10px 12px}
.password-area .actions{display:flex;justify-content:center;margin-top:6px}

/* Center block headings and make inputs taller but constrained width */
.profile-card h3{ text-align: center }
.profile-card .auth-input, .profile-card input.auth-input, .profile-card select.auth-input {
  padding: 12px 14px;
  font-size: 1rem;
  border-radius: 10px;
  height: auto;
  box-sizing: border-box;
  max-width: 40ch; /* limit overly wide inputs */
  width: 100%;
}

/* Ensure field containers shrink before overflowing */
.profile-card .field-row > div, .name-row > div { min-width: 0; max-width: 100% }

/* Narrower password inputs for better visual weight */
.password-area input.auth-input, .password-area input { max-width: 38ch }

/* Make save buttons a bit smaller to fit inline */
.field-row .btn { padding: 0.45rem 0.75rem; font-size: 0.95rem }

/* Smooth button hover */
.btn { transition: transform var(--theme-transition) ease, box-shadow var(--theme-transition) ease, opacity var(--theme-transition) ease }

/* Ensure save buttons never translate on hover; use box-shadow only. High specificity. */
.input-with-save .save-btn,
.input-with-save .save-btn:focus,
.input-with-save .save-btn:hover,
.input-with-save .save-btn:active{
  transform: translateY(calc(-50% + 3px)) !important; /* enforce consistent translate */
}
.input-with-save .save-btn:hover,
.input-with-save .save-btn:focus{
  box-shadow: 0 8px 22px rgba(var(--accent-rgb),0.16) !important;
}
.input-with-save .save-btn:active{
  box-shadow: 0 6px 14px rgba(var(--accent-rgb),0.10) !important;
}

/* Password show/hide toggle (only used for new password first input)
   - position the toggle absolutely so it never affects layout or inherits global button hover transforms
   - keep both inputs constrained to the same outer max-width so boxes match visually */
.pw-input-wrapper{ position: relative; width: 100%; max-width: 520px; }
.pw-input-wrapper .auth-input{ box-sizing: border-box; padding-right: 48px; width: 100%; }
.pw-toggle{
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-70%) !important;
  background: transparent;
  color: var(--muted);
  cursor: pointer;
  padding: 6px 8px;
  font-weight: 600;
  border-radius: 8px;
  display: inline-flex;align-items:center;justify-content:center;
  transition: none !important;
}
.pw-toggle:hover{ color: var(--text); }
.pw-toggle:focus{ outline: none; }

/* Ensure the password inputs in the password-area have identical sizing even when the first
   input reserves extra right padding for the toggle button. Box-sizing ensures padding doesn't
   change the visual width. */
.password-area .auth-input, .password-area input.auth-input, .password-area .auth-input input, .password-area input {
  box-sizing: border-box;
  width: 100%;
  max-width: 520px; /* ensure both inputs share identical outer width */
  padding-right: 14px; /* default inner padding for both inputs */
}

/* Reserve a modest extra right padding only for the first input wrapper so text doesn't overlap the toggle */
.pw-input-wrapper .auth-input, .pw-input-wrapper .auth-input input {
  padding-right: 48px;
}

/* Chat widget styles (added) */
.chat-widget {
  width: 380px;
  max-width: calc(100vw - 40px);
  /* heavy frosted glass morphism */
  background: rgba(255,255,255,0.06);
  color: var(--text, #111);
  border-radius: 14px;
  border: 1px solid rgba(var(--accent-rgb),0.12);
  backdrop-filter: blur(14px) saturate(140%);
  -webkit-backdrop-filter: blur(14px) saturate(140%);
  box-shadow: 0 10px 30px rgba(2,6,23,0.18);
  overflow: hidden;
  font-family: var(--font-sans);
  max-height: 40vh; /* cap widget height */
  display: flex;
  flex-direction: column;
}
.chat-widget-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 14px;
  cursor: grab;
  background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(0,0,0,0.02));
}
/* ensure the header doesn't trigger browser gestures and allows pointer capture */
.chat-widget-header { touch-action: none }
/* Debug info in header */
.chat-widget-body { display: flex; gap: 8px; padding: 8px; overflow: auto; flex: 1 1 auto }
.chat-partners { width: 140px; max-height: calc(40vh - 90px); overflow: auto; border-right: 1px solid rgba(0,0,0,0.06); padding-right:8px }
.partner-row { padding: 8px; border-radius: 8px; cursor: pointer; display:flex; justify-content:space-between }
.partner-row:hover { background: rgba(0,0,0,0.03) }
.partner-name { font-weight: 600 }
.partner-last { font-size: 11px }
.muted { color: #666; font-size: 12px }
.chat-badge { background: var(--accent, #0b84ff); color: white; padding: 2px 8px; border-radius: 999px; font-size: 12px }

.chat-window { width: 100%; max-width: 560px; display: flex; flex-direction: column; }
.chat-window-header { display:flex; justify-content:space-between; padding:8px 12px; border-bottom:1px solid rgba(0,0,0,0.05) }
.chat-window-body { padding: 12px; height: 360px; overflow: auto; background: linear-gradient(180deg, transparent, rgba(0,0,0,0.02)); }
.load-more { text-align:center; margin-bottom:8px; color: var(--accent, #0b84ff); cursor: pointer }
.message { margin-bottom: 10px; max-width: 78%; }
.message.sent { margin-left: auto; text-align: right }
.message.received { margin-right: auto }
.message-content { padding: 8px 10px; border-radius: 8px; background: rgba(0,0,0,0.04) }
.message.sent .message-content { background: var(--accent, #0b84ff); color: white }
.message-meta { font-size: 11px; color: #666; margin-top: 4px }
.chat-window-compose { display:flex; gap:8px; padding:8px; border-top:1px solid rgba(0,0,0,0.04) }
.chat-window-compose textarea { flex:1; min-height:40px; max-height:120px; resize:vertical; padding:8px; border-radius:8px; border:1px solid rgba(0,0,0,0.06) }
.btn.primary { background: var(--accent, #0b84ff); color:white; border:none; padding:8px 12px; border-radius:8px }





